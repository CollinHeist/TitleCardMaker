<!DOCTYPE html>
<html lang="en">

<head>
  <title>Settings - TitleCardMaker</title>
  {% include "./html_boilerplate.html" %}
  <script src="https://cdn.jsdelivr.net/npm/fomantic-ui@2.9.3/dist/semantic.min.js"></script>

  <script type="text/javascript">
    {% include "./js/settings.js" %}
  </script>
  
  <link rel="stylesheet" type="text/css" href="/templates/css/settings.css?v={{preferences.current_version}}"/>

  <template id="extra-input-template">
    <div class="field">
      <label>{label}</label>
      <input type="text">
      <p class="help">{tooltip}</p>
    </div>
  </template>
</head>

<body onload="initAll();">
  <div class="pusher">
    <!-- Static header and sidebar -->
    <div id="page-header">
      {% include "./header.html" %}
    </div>
    <div id="nav-menu">
      {% include "./settings_sidebar.html" %}
    </div>

    <!-- Actual page content -->
    <div id="main-content" class="article">
      <div class="ui stackable grid">
        <div id="settings" class="sixteen wide column">
          <h1 class="ui header">Settings</h1>
          {% if preferences.available_version is not none and preferences.available_version > preferences.current_version %}
          <div class="ui floating compact info message">
            <i class="info circle icon"></i>
            A new version of TitleCardMaker ({{preferences.available_version}}) is available.
          </div>
          <br>
          {% endif %}

          <form id="settings-form" class="ui fluid form">
            <!-- Series and Episode Data Settings -->
            <h3 class="ui horizontal divider header">
              <i class="database icon"></i>
              Series and Episode Data
            </h3>
            <section>
              <div class="two fields">
                <div class="field">
                  <label>Episode Data Source</label>
                  <div data-value="episode_data_source" class="ui compact selection dropdown">
                    <input type="hidden" name="episode_data_source">
                    <i class="dropdown icon"></i>
                    <div class="default text">Connection</div>
                    <div class="menu">
                      <!-- Added asynchronously -->
                    </div>
                  </div>
                  <p class="help">
                    Default Connection to source Episode Data from, i.e. which Episodes to make Cards for.
                    <br>
                    Can be overwritten per-Series.
                  </p>
                </div>
    
                <div class="field">
                  <label>Image Source Priority</label>
                  <div class="ui compact multiple selection dropdown" data-value="image_source_priority">
                    <input type="hidden" name="image_source_priority">
                    <i class="dropdown icon"></i>
                    <div class="default text">Image Sources</div>
                    <div class="menu"><!-- Added asynchronousely --></div>
                  </div>
                  <p class="help">Order of Connections to try and source textless images from.</p>
                </div>
              </div>
  
              <div class="two fields">
                <div class="ui checkbox field">
                  <label>Enable Specials</label>
                  {% if preferences.sync_specials %}
                  <input name="sync_specials" type="checkbox" checked="checked">
                  {% else %}
                  <input name="sync_specials" type="checkbox">
                  {% endif %}
                  <p class="help">
                    Whether to include Episodes from Season 0.
                    <br>
                    Can be overwritten per-Series.
                  </p>
                </div>
    
                <div class="ui checkbox field">
                  <label>Delete Missing Episodes</label>
                  {% if preferences.delete_missing_episodes %}
                  <input name="delete_missing_episodes" type="checkbox" checked="checked">
                  {% else %}
                  <input name="delete_missing_episodes" type="checkbox">
                  {% endif %}
                  <p class="help">Whether to delete Episodes no longer present in the assigned Episode Data Source.</p>
                </div>
              </div>

              <div class="two fields">
                <div class="ui checkbox field">
                  <label>Delete Un-Synced Series</label>
                  {% if preferences.delete_unsynced_series %}
                  <input name="delete_unsynced_series" type="checkbox" checked="checked">
                  {% else %}
                  <input name="delete_unsynced_series" type="checkbox">
                  {% endif %}
                  <p class="help">
                    Whether to delete Series which no longer appear in any Syncs.
                    <br>
                    <b>This will delete all Title Cards and manually added Series (if they are not in any Sync).</b>
                  </p>
                </div>

                <div class="ui checkbox field">
                  <label>Delete Series Source Images</label>
                  {% if preferences.completely_delete_series %}
                  <input name="completely_delete_series" type="checkbox" checked="checked">
                  {% else %}
                  <input name="completely_delete_series" type="checkbox">
                  {% endif %}
                  <p class="help">Whether to delete Source Images when deleting a Series.</p>
                </div>
              </div>
            </section>

            <!-- Title Card Settings -->
            <h3 class="ui horizontal divider header">
              <i class="images outline icon"></i>
              Title Cards
            </h3>
            <section>
              <!-- Card settings -->
              <div class="two fields">
                <div class="field">
                  <label>Default Card Type</label>
                  <div id="default-card-type" class="ui long compact search selection dropdown">
                    <span class="text"></span>
                    <input name="default_card_type" type="hidden" value="{{preferences.default_card_type.lower()}}">
                    <i class="dropdown icon"></i>
                    <div class="down menu"><!-- Added asynchronously --></div>
                  </div>
                  <p class="help">
                    Default type of Title Cards.
                    <br>
                    Can be overwritten per-Series.
                  </p>
                </div>

                <div class="field">
                  <label>Excluded Card Types</label>
                  <div id="excluded-card-types" class="ui long compact selection multiple dropdown">
                    <span class="text"></span>
                    <input name="excluded_card_types" type="hidden">
                    <i class="dropdown icon"></i>
                    <div class="down menu"><!-- Added asynchronously --></div>
                  </div>
                  <p class="help">
                    Card types to exclude from dropdowns.
                    <br>
                    Purely visual to make selecting types easier.
                  </p>
                </div>
              </div>
              
              <div class="two fields">
                <div class="field">
                  <label>Watched Episode Style</label>
                  <div class="ui long compact selection dropdown">
                    <span class="default text">{{preferences.default_watched_style.title()}}</span>
                    <input name="default_watched_style" type="hidden" value="{{preferences.default_watched_style}}">
                    <i class="dropdown icon"></i>
                    <div class="menu">
                      <div class="header">Art Variations</div>
                      <div class="divider"></div>
                      <div class="item" data-value="art">Art</div>
                      <div class="item" data-value="art blur">Blurred Art</div>
                      <div class="item" data-value="art grayscale">Grayscale Art</div>
                      <div class="item" data-value="art blur grayscale">Blurred Grayscale Art</div>

                      <div class="header">Unique Variations</div>
                      <div class="divider"></div>
                      <div class="item" data-value="unique">Unique</div>
                      <div class="item" data-value="blur unique">Blurred Unique</div>
                      <div class="item" data-value="grayscale unique">Grayscale Unique</div>
                      <div class="item" data-value="blur grayscale unique">Blurred Grayscale Unique</div>
                    </div>
                  </div>
                  <div data-value="style-button" class="ui primary tertiary icon button">
                    <i class="question circle outline icon"></i>
                  </div>
                  <p class="help">
                    Default style of Title Cards created for watched Episodes.
                    <br>
                    Can be overrwitten per-Series.
                  </p>
                </div>
  
                <div class="field">
                  <label>Unwatched Episode Style</label>
                  <div class="ui long compact selection dropdown">
                    <span class="default text">{{preferences.default_unwatched_style.title()}}</span>
                    <input name="default_unwatched_style" type="hidden" value="{{preferences.default_unwatched_style}}">
                    <i class="dropdown icon"></i>
                    <div class="menu">
                      <div class="header">Art</div>
                      <div class="divider"></div>
                      <div class="item" data-value="art">Art</div>
                      <div class="item" data-value="art blur">Blurred Art</div>
                      <div class="item" data-value="art grayscale">Grayscale Art</div>
                      <div class="item" data-value="art blur grayscale">Blurred Grayscale Art</div>
                      
                      <div class="header">Unique Variations</div>
                      <div class="divider"></div>
                      <div class="item" data-value="unique">Unique</div>
                      <div class="item" data-value="blur unique">Blurred Unique</div>
                      <div class="item" data-value="grayscale unique">Grayscale Unique</div>
                      <div class="item" data-value="blur grayscale unique">Blurred Grayscale Unique</div>
                    </div>
                  </div>
                  <div data-value="style-button" class="ui primary tertiary icon button">
                    <i class="question circle outline icon"></i>
                  </div>
                  <p class="help">
                    Default style of Title Cards created for unwatched Episodes.
                    <br>
                    Can be overrwitten per-Series.
                  </p>
                </div>
              </div>

              <div class="field">
                <label>Default Templates</label>
                <div data-value="default_templates" class="ui search selection clearable compact multiple dropdown">
                  <input name="default_templates" type="hidden">
                  <i class="dropdown icon"></i>
                  <div class="default text">None</div>
                  <div class="menu"><!-- Added asynchronously --></div>
                </div>
                <p class="help">Templates to apply to all Series when not directly specified.</p>
              </div>

              <!-- Card preview -->
              <div class="ui horizontal raised card">
                <div class="image">
                  <img alt="Preview Title Card" id="title-card-image" src="">
                </div>
                <div class="content">
                  <div id="title-card-name" class="header">CARD TYPE</div>
                  <div class="meta">
                    <span id="title-card-creators" class="author">AUTHOR(S)</span>
                    <br><span id="title-card-font-support"><i class="times icon"></i>Custom Fonts</span>
                    <br><span id="title-card-season-support"><i class="check icon"></i>Custom Season Titles</span>
                  </div>
                  <div id="title-card-description" class="description">
                    <p>DESCRIPTION(S)</p>
                  </div>
                </div>
              </div>

              <!-- Global extras -->
              <div class="ui visible info message">
                The following Card extras will be automatically applied to all Cards of that type.
              </div>
              <div class="ui styled fluid accordion">
                <div class="title">
                  <i class="dropdown icon"></i>
                  Global Extras
                </div>
                <div class="content">
                  <section aria-label="extras">
                    <div class="ui top attached tabular wrapping menu"></div>
                  </section>
                </div>
              </div>

            </section>

            <h3 class="ui horizontal divider header">
              <i class="magic icon"></i>
              ImageMagick
            </h3>
            <section data-name="ImageMagick">
              <div class="fields">
                <div class="four wide field">
                  <label>Card Width</label>
                  <div class="ui right labeled input">
                    <input name="card_width" type="number" placeholder="{{preferences.card_width}}" value="{{preferences.card_width}}">
                    <div class="ui basic label">
                      px
                    </div>
                  </div>
                </div>
                <div class="four wide field">
                  <label>Card Height</label>
                  <div class="ui right labeled input">
                    <input name="card_height" type="number" placeholder="{{preferences.card_height}}" value="{{preferences.card_height}}">
                    <div class="ui basic label">
                      px
                    </div>
                  </div>
                </div>
                <!-- <p class="help">Title Card dimensions (in pixels).</p> -->

                <div class="eight wide field" data-value="card_quality" data-label="Card Quality">
                  <label>Card Quality</label>
                  <div data-value="card_quality" class="ui labeled ticked blue slider" id="card-quality"></div>
                  <p class="help">
                    Compression quality to utilize when creating Title Cards.
                    <br>
                    Lower values are more compressed, while higher values are less.
                  </p>
                </div>
              </div>

              <div class="two fields">
                {% if preferences.is_docker %}
                <div class="disabled field" data-value="imagemagick_executable">
                {% else %}
                <div class="field" data-value="imagemagick_executable">
                {% endif %}
                  <label>ImageMagick Executable</label>
                  {% if preferences.imagemagick_executable %}
                  <input type="text" name="imagemagick_executable" placeholder="{{preferences.imagemagick_executable}}" value="{{preferences.imagemagick_executable}}">
                  {% else %}
                  <input type="text" name="imagemagick_executable" placeholder="Unspecified">
                  {% endif %}
                  <p class="help">
                    Path to the ImageMagick executable file for running commands with.
                    <br>
                    Only required for some Windows installations.
                  </p>
                </div>
              </div>
            </section>

            <!-- Folder Settings -->
            <h3 class="ui horizontal divider header">
              <i class="folder open outline icon"></i>
              Root Folders
            </h3>
            <section>
              <p class="help">Restart TitleCardMaker for changes to either of these directories to take effect.</p>
              
              <div class="ui two fields">
                <div class="field">
                  <label>Title Card Directory</label>
                  <input type="text" name="card_directory" placeholder="{{preferences.card_directory}}" value="{{preferences.card_directory}}">
                  <p class="help">
                    Directory to store all Title Cards.
                    <br>
                    Can be overrwitten per-Series.
                  </p>
                </div>
  
                <div class="field">
                  <label>Source Directory</label>
                  <input type="text" name="source_directory" placeholder="{{preferences.source_directory}}" value="{{preferences.source_directory}}">
                  <p class="help">Directory to store all textless source images.</p>
                </div>
              </div>
            </section>

            <!-- Filename Settings -->
            <h3 class="ui horizontal divider header">
              <i class="file outline icon"></i>
              File Naming
            </h3>
            <section>
              <div class="fields">
                <div class="twelve wide field">
                  <label>Title Card Filename Format</label>
                  <input type="text" name="card_filename_format" placeholder="{{preferences.card_filename_format}}" value="{{preferences.card_filename_format}}">
                  <p class="help">
                    Format of how to name Title Cards.
                    <br>
                    <a href="https://titlecardmaker.com/user_guide/settings/#filename-format" target="_blank">See here</a> for some examples.
                  </p>
                </div>

                <div class="four wide field">
                  <label>Card Extension</label>
                  <div id="card-extension" class="ui selection dropdown">
                    <input id="card-extension-input" type="hidden" name="card_extension" value="{{preferences.card_extension}}">
                    <i class="dropdown icon"></i>
                    <div class="default text">{{preferences.card_extension}}</div>
                    <div id="card-extension-choices" class="menu">
                      {% for extension in preferences.VALID_IMAGE_EXTENSIONS %}
                      <div class="item" data-value="{{extension}}">{{extension}}</div>
                      {% endfor %}
                    </div>
                  </div>
                  <p class="help">File extension of Title Cards.</p>
                </div>
              </div>

              <!-- Filesize warning for uncompressed images -->
              <div id="card-extension-warning" class="ui compact floating warning message">
                <i class="exclamation triangle icon"></i>
                <b>Warning</b> Uncompressed images will significantly increase the file size of title cards.
              </div>
              
              <div class="field">
                <div class="two fields">
                  <div class="field">
                    <label>Specials Folder Format</label>
                    <input type="text" name="specials_folder_format" placeholder="{{preferences.specials_folder_format}}" value="{{preferences.specials_folder_format}}">
                    <p class="help">Name of the Season 0 subfolder for Title Cards.</p>
                  </div>
                  <div class="field">
                    <label>Season Folder Format</label>
                    <input type="text" name="season_folder_format" placeholder="{{preferences.season_folder_format}}" value="{{preferences.season_folder_format}}">
                    <p class="help">Format of all the non-special Title Card subfolders. {season_number} is the season number variable.</p>
                  </div>
                </div>
              </div>

              <div class="ui checkbox field">
                <label>Multi-Library File Naming</label>
                {% if preferences.library_unique_cards %}
                <input name="library_unique_cards" type="checkbox" checked="">
                {% else %}
                <input name="library_unique_cards" type="checkbox">
                {% endif %}
                <p class="help">
                  Whether to add a unique Library identifier to Title Card filenames to allow library-specific Title Cards.
                  <br>
                  Users whose Series are only part of a single library, or who do not use watch-status specific styling, should leave this disabled.
                  <br>
                  <b>If enabled, TitleCardMaker will create one Title Card for each Episode for each Library.</b>
                </p>
              </div>
            </section>

            <h3 class="ui horizontal divider header">
              <!-- <i class="wrench icon"></i> -->
              <i class="universal access icon"></i>
              Web Interface
            </h3>
            <section>
              <div class="ui two fields">
                <div class="eight wide field">
                  <label>Home Page Size</label>
                  <input type="number" name="home_page_size" placeholder="{{preferences.home_page_size}}" value="{{preferences.home_page_size}}" min="1">
                  <p class="help">How many Series per page to display on the home screen. Minimum 1.</p>
                </div>
    
                <div class="eight wide field">
                  <label>Episode Data Table Page Size</label>
                  <input type="number" name="episode_data_page_size" placeholder="{{preferences.episode_data_page_size}}" value="{{preferences.episode_data_page_size}}" min="1">
                  <p class="help">How many Episodes per page to display in Episode data tables. Minimum 1.</p>
                </div>
              </div>
  
              <div class="ui two fields">
                <div class="ui checkbox field" data-value="home_page_table_view">
                  <label>Display Home Page as a Table</label>
                  {% if preferences.home_page_table_view %}
                  <input name="home_page_table_view" type="checkbox" checked="">
                  {% else %}
                  <input name="home_page_table_view" type="checkbox">
                  {% endif %}
                  <p class="help">Whether to display Series on the home page in a table.</p>
                </div>
                
                <div class="ui checkbox field">
                  <label>Display Source Image Data as a Table</label>
                  {% if preferences.sources_as_table %}
                  <input name="sources_as_table" type="checkbox" checked="checked">
                  {% else %}
                  <input name="sources_as_table" type="checkbox">
                  {% endif %}
                  <p class="help">Whether to display source image data in a table.</p>
                </div>
              </div>
              
              <div class="ui two fields">
                <div class="ui checkbox field" data-value="simplified_data_table">
                  <label>Simplified Episode Data Tables</label>
                  {% if preferences.simplified_data_table %}
                  <input name="simplified_data_table" type="checkbox" checked="">
                  {% else %}
                  <input name="simplified_data_table" type="checkbox">
                  {% endif %}
                  <p class="help">Whether to hide "advanced" (uncommonly edited) columns from Episode data tables.</p>
                </div>
    
                <div class="ui checkbox field">
                  <label>Stylize Unmonitored Posters</label>
                  {% if preferences.stylize_unmonitored_posters %}
                  <input name="stylize_unmonitored_posters" type="checkbox" checked="checked">
                  {% else %}
                  <input name="stylize_unmonitored_posters" type="checkbox">
                  {% endif %}
                  <p class="help">Whether to stylize the posters of Unmonitored Series on the home page.</p>
                </div>
              </div>
  
              <div class="ui two fields">
                <div class="ui checkbox field">
                  <label>Color-Impaired Mode</label>
                  {% if preferences.colorblind_mode %}
                  <input name="colorblind_mode" type="checkbox" checked="checked">
                  {% else %}
                  <input name="colorblind_mode" type="checkbox">
                  {% endif %}
                  <p class="help">Utilize alternate styling with more distinguished colors.</p>
                </div>
                <br>
    
                <div class="ui checkbox field">
                  <label>Reduced Animations</label>
                  {% if preferences.reduced_animations %}
                  <input name="reduced_animations" type="checkbox" checked="checked">
                  {% else %}
                  <input name="reduced_animations" type="checkbox">
                  {% endif %}
                  <p class="help">Reduce website animations.</p>
                </div>
              </div>

              <div class="ui two fields">
                <div class="ui checkbox field">
                  <label>Interactive Title Cards</label>
                  {% if preferences.interactive_card_previews %}
                  <input name="interactive_card_previews" type="checkbox" checked="checked">
                  {% else %}
                  <input name="interactive_card_previews" type="checkbox">
                  {% endif %}
                  <p class="help">Whether to add click and right-click functionality to the Title Card previews on the Series pages.</p>
                </div>

                <div class="ui checkbox field">
                  <label>Display Live Log Messages</label>
                  {% if preferences.display_live_messages %}
                  <input name="display_live_messages" type="checkbox" checked="checked">
                  {% else %}
                  <input name="display_live_messages" type="checkbox">
                  {% endif %}
                  <p class="help">Whether to display real-time log messages within the UI.</p>
                </div>
              </div>
            </section>

            <!-- Validation message -->
            <div class="ui floating error message"></div>
            
            <!-- Submit button -->
            <br>
            <button id="save-changes" class="ui primary animated button" type="submit">
              <div class="visible content">Save Changes</div>
              <div class="hidden content">
                <i class="right arrow icon"></i>
              </div>
            </button>
          </form>

          <!-- System info -->
          <div class="ui divider"></div>
          <div class="system info">
            <div class="ui blue label">
              Current Version
              <div class="detail">{{ preferences.current_version }}</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Episode style modal -->
    <div id="style-modal" class="ui large modal">
      <i class="close icon"></i>
      <div class="header">Episode Styles</div>
      <div class="image content">
        <div class="ui stackable four column grid">
          <!-- Headers -->
          <div class="eight wide column">
            <h3 class="ui header">Art Styles</h3>
            <span><span class="ui red text">Art</span> styles utilize <span class="ui red text">series artwork</span> instead of episode unique images.</span>
            <span>Cards in this style will use the source image <span class="ui teal text">backdrop.jpg</span> by default.</span>
          </div>
          <div class="eight wide column">
            <h3 class="ui header">Unique Styles</h3>
            <span><span class="ui blue text">Unique</span> styles utilize <span class="ui blue text">episode backdrops</span> unique to each episode.</span>
            <span>Cards in this style will use the source image <span class="ui teal text">s{season_number}e{episode_number}.jpg</span> (e.g. <span class="ui teal text">s1e1.jpg</span>) by default.</span>
          </div>
          
          <div class="four wide column">
            <div class="ui fluid image">
              <div class="ui teal ribbon label">Art</div>
              <img src="/internal_assets/styles/art.jpg">
            </div>
          </div>
          <div class="four wide column">
            <div class="ui fluid image">
              <div class="ui teal ribbon label">Blurred Art</div>
              <img src="/internal_assets/styles/art blur.jpg">
            </div>
          </div>
          <div class="four wide column">
            <div class="ui fluid image">
              <div class="ui blue right ribbon label">Unique</div>
              <img src="/internal_assets/styles/unique.jpg">
            </div>
          </div>
          <div class="four wide column">
            <div class="ui fluid image">
              <div class="ui blue right ribbon label">Blurred Unique</div>
              <img src="/internal_assets/styles/unique blur.jpg">
            </div>
          </div>
          <div class="four wide column">
            <div class="ui fluid image">
              <div class="ui teal ribbon label">Grayscale Art</div>
              <img src="/internal_assets/styles/art grayscale.jpg">
            </div>
          </div>
          <div class="four wide column">
            <div class="ui fluid image">
              <div class="ui teal ribbon label">Blurred Grayscale Art</div>
              <img src="/internal_assets/styles/art blur grayscale.jpg">
            </div>
          </div>
          <div class="four wide column">
            <div class="ui fluid image">
              <div class="ui blue right ribbon label">Grayscale Unique</div>
              <img src="/internal_assets/styles/unique grayscale.jpg">
            </div>
          </div>
          <div class="four wide column">
            <div class="ui fluid image">
              <div class="ui blue right ribbon label">Blurred Grayscale Unique</div>
              <img src="/internal_assets/styles/unique blur grayscale.jpg">
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    
  </script>
</body>

</html>